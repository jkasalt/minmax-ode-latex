\documentclass[main.tex]{subfiles}

\begin{document}
\section{The process}
In light of \cite{luResolutionODEFramework2021} we present here a method to
obtain differential equations from discrete algorithms. We assume that the
velocity depends on the current position in the following way
\[ \dot Z(t) = f_0(Z(t)) + sf_1(Z(t)) + s^2f_2(Z(t)) + \dots \]
We want to find what are the $f_i$ functions.
To alleviate the notation we will write $Z$ instead of $Z(t)$.
We obtain a Taylor expansion
\begin{align*}
	Z(t + s) & = Z + s(f_0(Z) + sf_1(Z) + \dots)                                                      \\
	         & + \frac{s^2}{2}(f'_0(Z) + sf'_1(Z) + \dots)(f_0(Z) + sf_1(Z) + \dots) + \dots + o(s^r)
\end{align*}\label{eq:taylor-x}
On the other hand, given a numerical algorithm $z_{n+1} = \varphi(z_n, s)$
we can also express it as a Taylor expansion on $s$,
\[\varphi(z, s) = \varphi(z, 0) + s \partial_s \varphi(z, s) + \frac{s^2}{2} \partial_{ss} \varphi(z, s) + \dots + o(s^r) .\]
In order to obtain $Z(t_n) = z_n$ like the intuition in the introduction, we
need to have $\varphi(z,s) = Z(t+s)$.
By equating the coefficients in $s$ for both polynomials we find that
\begin{align*}
	f_0   & = \partial_s \varphi                \\
	2 f_1 & = \partial_{ss} \varphi - f_0' f_0,
\end{align*}
and the other coefficients are found in the same manner.

\begin{ex}
	With GDA we find that $\partial_s \varphi(z,s) = \nabla l(z)$ and that $\partial_{ss} \varphi(z,s) = 0$.
	So, the first two coefficients are \begin{align*}
		f_0 & = \nabla l(z)                            \\
		f_1 & = - \frac{1}{2}\nabla^2 l(z) \nabla l(z)
	\end{align*}
\end{ex}

\begin{ex}
	With EG the update rule is $\varphi(z,s) = z + s\nabla l(z + s\nabla
		l(z)).$ By Taylor expansion of the second term, we find that this
	expression equals
	\[z + s \nabla l(z) + s^2 \nabla^2 l(z) \nabla l(z) + \frac{s^3}{2}
		\nabla^2 l(z) \nabla l(z) \nabla l(z).\]
    By equating the two polynomials as usual we find that \begin{align*}
        f_0 &=  \nabla l(z) \\
        f_1 &= \frac{1}{2}\nabla^2 l(z) \nabla l(z)
    \end{align*}
\end{ex}

\section{Example: Mirror descent $O(s^r)$-resolution ODE}

On the other hand, mirror descent uses as update rule
\[ g(x, s) = \nabla\psi^{-1}(\nabla\psi(x) + s \nabla F(x)) \]
The derivatives are
\begin{align*}
	\partial_s g(x, s)    & = \nabla_s \nabla \psi^{-1}(\nabla\psi(x) + s \nabla F(x))\nabla F(x)                      \\
	\partial_{ss} g(x, s) & = \nabla^2_s \nabla \psi^{-1}(\nabla\psi(x) + s \nabla F(x)) \nabla F(x) \cdot \nabla F(x) \\
\end{align*}

We consider the Taylor expansion of $g(x,s)$ w.r.t.\ $s$ and equate the coefficients of both polynomials to find
\begin{align*}
	f_0                             & = \partial_s g(x,s)                                                                                         \\
	f_1 + \frac{1}{2}f'_0 \cdot f_0 & = \partial_{ss} g(x,s)                                                                                      \\
	\implies f_1                    & = \nabla^2_s \nabla \psi^{-1}(\nabla\psi(x) + s \nabla F(x)) \nabla F(x) \cdot \nabla F(x)                  \\
	                                & + \frac{1}{2}\nabla_s \nabla^2 \psi^{-1}(\nabla \psi (x) + s \nabla F(x))(\nabla^2 \psi(x) + s\nabla^2F(x)) \\
	                                & \ \cdot  \nabla_s \nabla \psi^{-1}(\nabla\psi(x) + s \nabla F(x))\nabla F(x)
\end{align*}
\end{document}

